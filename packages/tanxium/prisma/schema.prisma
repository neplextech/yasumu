generator client {
    provider               = "prisma-client"
    engineType             = "client"
    moduleFormat           = "esm"
    generatedFileExtension = "ts"
    importFileExtension    = "ts"
    runtime                = "deno"
    output                 = "../src/prisma"
}

datasource db {
    provider     = "sqlite"
    url          = "file:./yasumu.db"
    relationMode = "foreignKeys"
}

model Workspace {
    id                     String                   @id @default(cuid())
    name                   String
    metadata               Json                     @default("\"{}\"") // arbitrary key-value store
    createdAt              DateTime                 @default(now())
    updatedAt              DateTime                 @updatedAt
    RestEntity             RestEntity[]
    WorkspaceConfiguration WorkspaceConfiguration[]
}

model WorkspaceConfiguration {
    id           String    @id @default(cuid())
    smtpPort     Int?
    smtpUsername String?
    smtpPassword String?
    metadata     Json      @default("\"{}\"") // arbitrary key-value store
    createdAt    DateTime  @default(now())
    updatedAt    DateTime  @updatedAt
    workspaceId  String    @unique
    workspace    Workspace @relation(fields: [workspaceId], references: [id], onDelete: Cascade)

    @@index([workspaceId])
}

model RestEntity {
    id        String   @id @default(cuid())
    name      String
    metadata  Json     @default("\"{}\"") // arbitrary key-value store
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    workspaceId String
    workspace   Workspace @relation(fields: [workspaceId], references: [id], onDelete: Cascade)

    @@index([workspaceId])
}
